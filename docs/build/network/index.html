<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Network · ModelVerification.jl</title><meta name="title" content="Network · ModelVerification.jl"/><meta property="og:title" content="Network · ModelVerification.jl"/><meta property="twitter:title" content="Network · ModelVerification.jl"/><meta name="description" content="Documentation for ModelVerification.jl."/><meta property="og:description" content="Documentation for ModelVerification.jl."/><meta property="twitter:description" content="Documentation for ModelVerification.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="ModelVerification.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ModelVerification.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">ModelVerification.jl</a></li><li><span class="tocitem">Toolbox Outline</span><ul><li><input class="collapse-toggle" id="menuitem-2-1" type="checkbox" checked/><label class="tocitem" for="menuitem-2-1"><span class="docs-label">Problem</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../problem/">Problem Outline</a></li><li class="is-active"><a class="tocitem" href>Network</a><ul class="internal"><li><a class="tocitem" href="#Network-2"><span>Network</span></a></li><li><a class="tocitem" href="#Activation-Functions"><span>Activation Functions</span></a></li><li><a class="tocitem" href="#Helper-Functions"><span>Helper Functions</span></a></li></ul></li><li><a class="tocitem" href="../safety_spec/">Input-Output Specification</a></li></ul></li><li><a class="tocitem" href="../branching/">Branching</a></li><li><a class="tocitem" href="../propagate/">Propagation</a></li><li><a class="tocitem" href="../solvers/">Solvers</a></li><li><a class="tocitem" href="../attack/">Attacks</a></li><li><a class="tocitem" href="../utils/">Helper Functions</a></li></ul></li><li><span class="tocitem">Python Interface</span><ul><li><a class="tocitem" href="../nnet_converter/">NNet Converter</a></li><li><a class="tocitem" href="../python_interface/">Python Interface</a></li></ul></li><li><span class="tocitem">Benchmarks </span><ul><li><a class="tocitem" href="../benchmark/">Benchmark</a></li></ul></li><li><a class="tocitem" href="../existing_implementations/">Existing Implementations</a></li><li><a class="tocitem" href="../about/">About</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Toolbox Outline</a></li><li><a class="is-disabled">Problem</a></li><li class="is-active"><a href>Network</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Network</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/intelligent-control-lab/ModelVerification.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/master/docs/src/network.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><ul><li><a href="#Network">Network</a></li><li class="no-marker"><ul><li><a href="#Network-2">Network</a></li><li><a href="#Activation-Functions">Activation Functions</a></li><li><a href="#Helper-Functions">Helper Functions</a></li></ul></li></ul><h1 id="Network"><a class="docs-heading-anchor" href="#Network">Network</a><a id="Network-1"></a><a class="docs-heading-anchor-permalink" href="#Network" title="Permalink"></a></h1><h2 id="Network-2"><a class="docs-heading-anchor" href="#Network-2">Network</a><a class="docs-heading-anchor-permalink" href="#Network-2" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.Layer" href="#ModelVerification.Layer"><code>ModelVerification.Layer</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Layer{F, N}</code></pre><p>Consists of <code>weights</code> and <code>bias</code> for linear mapping, and <code>activation</code> for nonlinear mapping.</p><p><strong>Fields</strong></p><ul><li><code>weights::Matrix{N}</code></li><li><code>bias::Vector{N}</code></li><li><code>activation::F</code></li></ul><p>See also: <a href="#ModelVerification.Network"><code>Network</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/network.jl#L3-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.Network" href="#ModelVerification.Network"><code>ModelVerification.Network</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A Vector of layers.</p><pre><code class="nohighlight hljs">Network([layer1, layer2, layer3, ...])</code></pre><p>See also: <a href="#ModelVerification.Layer"><code>Layer</code></a></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/network.jl#L20-L26">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.n_nodes-Tuple{ModelVerification.Layer}" href="#ModelVerification.n_nodes-Tuple{ModelVerification.Layer}"><code>ModelVerification.n_nodes</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">n_nodes(L::Layer)</code></pre><p>Returns the number of neurons in a layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/network.jl#L31-L35">source</a></section></article><h2 id="Activation-Functions"><a class="docs-heading-anchor" href="#Activation-Functions">Activation Functions</a><a id="Activation-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Activation-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.ActivationFunction" href="#ModelVerification.ActivationFunction"><code>ModelVerification.ActivationFunction</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ActivationFunction</code></pre><p>Function that calculates the output of the node. Supported activation functions are:</p><ul><li>ReLU (<code>ReLU</code>)</li><li>Max (<code>Max</code>)</li><li>Identity (<code>Id</code>)</li><li>Sigmoid (<code>Sigmoid</code>)</li><li>Tanh (<code>Tanh</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/activation.jl#L3-L13">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.GeneralAct" href="#ModelVerification.GeneralAct"><code>ModelVerification.GeneralAct</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">GeneralAct &lt;: ActivationFunction</code></pre><p>Wrapper type for a general activation function.</p><p><strong>Usage</strong></p><pre><code class="language-julia hljs">act = GeneralAct(tanh)

act(0) == tanh(0)           # true
act(10.0) == tanh(10.0)     # true</code></pre><pre><code class="language-julia hljs">act = GeneralAct(x-&gt;tanh.(x))

julia&gt; act(-2:2)
5-element Array{Float64,1}:
 -0.9640275800758169
 -0.7615941559557649
  0.0
  0.7615941559557649
  0.9640275800758169</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/activation.jl#L53-L76">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.Id" href="#ModelVerification.Id"><code>ModelVerification.Id</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Id &lt;: ActivationFunction</code></pre><p>Identity operator</p><p>(Id())(x) -&gt; x</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/activation.jl#L30-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.Max" href="#ModelVerification.Max"><code>ModelVerification.Max</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Max &lt;: ActivationFunction</code></pre><p>(Max())(x) -&gt; max(maximum(x), 0)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/activation.jl#L23-L27">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.PiecewiseLinear" href="#ModelVerification.PiecewiseLinear"><code>ModelVerification.PiecewiseLinear</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PiecewiseLinear &lt;: ActivationFunction</code></pre><p>Activation function that uses linear interpolation between supplied <code>knots</code>. An extrapolation condition can be set for values outside the set of knots. Default is <code>Linear</code>.</p><pre><code class="nohighlight hljs">PiecewiseLinear(knots_x, knots_y, [extrapolation = Line()])</code></pre><p><strong>Usage</strong></p><pre><code class="language-julia hljs">kx = [0.0, 1.2, 1.7, 3.1]
ky = [0.0, 0.5, 1.0, 1.5]
act = PiecewiseLinear(kx, ky)

act(first(kx)) == first(ky) == 0.0
act(last(kx))  == last(ky)  == 1.5

act(1.0)    # 0.4166666666666667
act(-102)   # -42.5</code></pre><pre><code class="language-julia hljs">act = PiecewiseLinear(kx, ky, Flat())

act(-102)   # 0.0
act(Inf)    # 1.5</code></pre><p><strong>Extrapolations</strong></p><ul><li>Flat()</li><li>Line()</li><li>constant (supply a number as the argument)</li><li>Throw() (throws bounds error)</li></ul><p><code>PiecewiseLinear</code> uses <a href="http://juliamath.github.io/Interpolations.jl/latest/">Interpolations.jl</a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/activation.jl#L86-L119">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.ReLU" href="#ModelVerification.ReLU"><code>ModelVerification.ReLU</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ReLU &lt;: ActivationFunction</code></pre><p>(ReLU())(x) -&gt; max.(x, 0)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/activation.jl#L16-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.Sigmoid" href="#ModelVerification.Sigmoid"><code>ModelVerification.Sigmoid</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Sigmoid &lt;: ActivationFunction</code></pre><p>(Sigmoid())(x) -&gt; 1 ./ (1 .+ exp.(-x))</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/activation.jl#L39-L43">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.Tanh" href="#ModelVerification.Tanh"><code>ModelVerification.Tanh</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Tanh &lt;: ActivationFunction</code></pre><p>(Tanh())(x) -&gt; tanh.(x)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/activation.jl#L46-L50">source</a></section></article><h2 id="Helper-Functions"><a class="docs-heading-anchor" href="#Helper-Functions">Helper Functions</a><a id="Helper-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Helper-Functions" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.act_gradient-Tuple{ModelVerification.ReLU, Vector}" href="#ModelVerification.act_gradient-Tuple{ModelVerification.ReLU, Vector}"><code>ModelVerification.act_gradient</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">act_gradient(act, z_hat::Vector{N}) where N</code></pre><p>Compute the gradient of an activation function at point z_hat. Currently only supports ReLU and Id.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L233-L238">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.act_gradient_bounds-Tuple{ModelVerification.Network, LazySets.AbstractPolytope}" href="#ModelVerification.act_gradient_bounds-Tuple{ModelVerification.Network, LazySets.AbstractPolytope}"><code>ModelVerification.act_gradient_bounds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">act_gradient_bounds(nnet::Network, input::AbstractPolytope)</code></pre><p>Compute the bounds on the gradient of all activation functions given an input set. Currently only support ReLU. Return:</p><ul><li><code>LΛ, UΛ::NTuple{2, Vector{BitVector}}</code>: lower and upper bounds on activation</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L256-L263">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.affine_map-Tuple{Flux.Dense, Any}" href="#ModelVerification.affine_map-Tuple{Flux.Dense, Any}"><code>ModelVerification.affine_map</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">affine_map(layer, x)</code></pre><p>Compute W*x ⊕ b for a vector or LazySet <code>x</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/propagate/operators/util.jl#L2-L6">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.affine_map-Tuple{ModelVerification.Layer, Any}" href="#ModelVerification.affine_map-Tuple{ModelVerification.Layer, Any}"><code>ModelVerification.affine_map</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">affine_map(layer, x)</code></pre><p>Compute W*x ⊕ b for a vector or LazySet <code>x</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L347-L351">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.approximate_act_map-Tuple{ModelVerification.ActivationFunction, LazySets.Hyperrectangle}" href="#ModelVerification.approximate_act_map-Tuple{ModelVerification.ActivationFunction, LazySets.Hyperrectangle}"><code>ModelVerification.approximate_act_map</code></a> — <span class="docstring-category">Method</span></header><section><div><p>approximate<em>act</em>map(layer, input::Hyperrectangle)</p><p>Returns a Hyperrectangle overapproximation of the activation map of the input. <code>act</code>must be monotonic.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L369-L374">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.approximate_affine_map-Tuple{ModelVerification.Layer, LazySets.Hyperrectangle}" href="#ModelVerification.approximate_affine_map-Tuple{ModelVerification.Layer, LazySets.Hyperrectangle}"><code>ModelVerification.approximate_affine_map</code></a> — <span class="docstring-category">Method</span></header><section><div><p>approximate<em>affine</em>map(layer, input::Hyperrectangle)</p><p>Returns a Hyperrectangle overapproximation of the affine map of the input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L358-L362">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.broadcast_mid_dim-Union{Tuple{T1}, Tuple{T2}, Tuple{AbstractMatrix{T1}, AbstractArray{T2, 3}}} where {T2, T1}" href="#ModelVerification.broadcast_mid_dim-Union{Tuple{T1}, Tuple{T2}, Tuple{AbstractMatrix{T1}, AbstractArray{T2, 3}}} where {T2, T1}"><code>ModelVerification.broadcast_mid_dim</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">broadcast_mid_dim(m::AbstractArray{2}, target::AbstractArray{T,3})</code></pre><p>Given a target tensor of the shape AxBxC,  broadcast the 2D mask of the shape AxC to AxBxC.</p><p>Outputs:</p><ul><li><code>m</code> broadcasted.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/propagate/operators/util.jl#L30-L38">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.compute_output-Tuple{ModelVerification.Network, Any}" href="#ModelVerification.compute_output-Tuple{ModelVerification.Network, Any}"><code>ModelVerification.compute_output</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">compute_output(nnet::Network, input::Vector{Float64})</code></pre><p>Propagate a given vector through a nnet and compute the output.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L120-L124">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.get_activation-Tuple{ModelVerification.Layer{ModelVerification.ReLU}, LazySets.Hyperrectangle}" href="#ModelVerification.get_activation-Tuple{ModelVerification.Layer{ModelVerification.ReLU}, LazySets.Hyperrectangle}"><code>ModelVerification.get_activation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_activation(L::Layer{ReLU}, bounds::Hyperrectangle)</code></pre><p>Given a layer, find the activation pattern of all neurons in the layer given the node-wise bounds. Assume ReLU. Assume bounds is the pre-activation bounds for each ReLU in the layer. return Vector{Vector{Int64}}.</p><ul><li>1: activated</li><li>0: undetermined</li><li>-1: not activated</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L192-L201">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.get_activation-Tuple{ModelVerification.Layer{ModelVerification.ReLU}, Vector}" href="#ModelVerification.get_activation-Tuple{ModelVerification.Layer{ModelVerification.ReLU}, Vector}"><code>ModelVerification.get_activation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_activation(L, x::Vector)</code></pre><p>Finds the activation pattern of a vector <code>x</code> subject to the activation function given by the layer <code>L</code>. Returns a Vector{Bool} where <code>true</code> denotes the node is &quot;active&quot;. In the sense of ReLU, this would be <code>x[i] &gt;= 0</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L133-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.get_activation-Tuple{ModelVerification.Network, LazySets.Hyperrectangle}" href="#ModelVerification.get_activation-Tuple{ModelVerification.Network, LazySets.Hyperrectangle}"><code>ModelVerification.get_activation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_activation(nnet::Network, input::Hyperrectangle)</code></pre><p>Given a network, find the activation pattern of all neurons for a given input set. Assume ReLU. return Vector{Vector{Int64}}.</p><ul><li>1: activated</li><li>0: undetermined</li><li>-1: not activated</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L158-L167">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.get_activation-Tuple{ModelVerification.Network, Vector{Float64}}" href="#ModelVerification.get_activation-Tuple{ModelVerification.Network, Vector{Float64}}"><code>ModelVerification.get_activation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_activation(nnet::Network, x::Vector)</code></pre><p>Given a network, find the activation pattern of all neurons at a given point x. Returns Vector{Vector{Bool}}. Each Vector{Bool} refers to the activation pattern of a particular layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L141-L146">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.get_activation-Tuple{ModelVerification.Network, Vector{LazySets.Hyperrectangle}}" href="#ModelVerification.get_activation-Tuple{ModelVerification.Network, Vector{LazySets.Hyperrectangle}}"><code>ModelVerification.get_activation</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_activation(nnet::Network, bounds::Vector{Hyperrectangle})</code></pre><p>Given a network, find the activation pattern of all neurons given the node-wise bounds. Assume ReLU. Assume pre-activation bounds where the bounds on the input are given by the first hyperrectangle, the first hidden layer by the second hyperrectangle, and so on. return Vector{Vector{Int64}}.</p><ul><li>1: activated</li><li>0: undetermined</li><li>-1: not activated</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L173-L183">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.get_bounds-Tuple{ModelVerification.Network, Any}" href="#ModelVerification.get_bounds-Tuple{ModelVerification.Network, Any}"><code>ModelVerification.get_bounds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_bounds(problem::Problem)
get_bounds(nnet::Network, input::Hyperrectangle, [true])</code></pre><p>Computes node-wise bounds given a input set. The optional last argument determines whether the bounds are pre- or post-activation.</p><p>Return:</p><ul><li><code>Vector{Hyperrectangle}</code>: bounds for all nodes. <code>bounds[1]</code> is the input set.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L319-L328">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.get_gradient-Tuple{ModelVerification.Network, Vector}" href="#ModelVerification.get_gradient-Tuple{ModelVerification.Network, Vector}"><code>ModelVerification.get_gradient</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_gradient(nnet::Network, x::Vector)</code></pre><p>Given a network, find the gradient at the input x</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L216-L220">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.get_gradient_bounds-Tuple{ModelVerification.Network, LazySets.AbstractPolytope}" href="#ModelVerification.get_gradient_bounds-Tuple{ModelVerification.Network, LazySets.AbstractPolytope}"><code>ModelVerification.get_gradient_bounds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">get_gradient_bounds(nnet::Network, LΛ::Vector{AbstractVector}, UΛ::Vector{AbstractVector})
get_gradient_bounds(nnet::Network, input::AbstractPolytope)</code></pre><p>Get lower and upper bounds on network gradient for given gradient bounds on activations, or given an input set. Return:</p><ul><li><code>(LG, UG)::NTuple{2, Matrix{Float64}</code> lower and upper bounds.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L280-L287">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.interval_map-Union{Tuple{N}, Tuple{AbstractMatrix{N}, AbstractVecOrMat, AbstractVecOrMat}} where N" href="#ModelVerification.interval_map-Union{Tuple{N}, Tuple{AbstractMatrix{N}, AbstractVecOrMat, AbstractVecOrMat}} where N"><code>ModelVerification.interval_map</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">interval_map(W::Matrix, l::AbstractVecOrMat, u::AbstractVecOrMat)</code></pre><p>Simple linear mapping on intervals. <code>L, U := ([W]₊*l + [W]₋*u), ([W]₊*u + [W]₋*l)</code></p><p>Outputs:</p><ul><li><code>(lbound, ubound)</code> (after the mapping)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L304-L312">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.print_header-Tuple{IOStream, Any}" href="#ModelVerification.print_header-Tuple{IOStream, Any}"><code>ModelVerification.print_header</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">print_header(file::IOStream, network[; header_text])</code></pre><p>The NNet format has a particular header containing information about the network size and training data. <code>print_header</code> does not take training-related information into account (subject to change).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L68-L73">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.print_layer-Tuple{IOStream, Any}" href="#ModelVerification.print_layer-Tuple{IOStream, Any}"><code>ModelVerification.print_layer</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">print_layer(file::IOStream, layer)</code></pre><p>Print to <code>file</code> an object implementing <code>weights(layer)</code> and <code>bias(layer)</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L55-L59">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.read_layer" href="#ModelVerification.read_layer"><code>ModelVerification.read_layer</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">read_layer(output_dim::Int, f::IOStream, [act = ReLU()])</code></pre><p>Read in layer from nnet file and return a <code>Layer</code> containing its weights/biases. Optional argument <code>act</code> sets the activation function for the layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L31-L36">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.read_nnet-Tuple{String}" href="#ModelVerification.read_nnet-Tuple{String}"><code>ModelVerification.read_nnet</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">read_nnet(fname::String; last_layer_activation = Id())</code></pre><p>Read in neural net from a <code>.nnet</code> file and return Network struct. The <code>.nnet</code> format is borrowed from <a href="https://github.com/sisl/NNet">NNet</a>. The format assumes all hidden layers have ReLU activation. Keyword argument <code>last_layer_activation</code> sets the activation of the last layer, and defaults to <code>Id()</code>, (i.e. a linear output layer).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.relaxed_relu_gradient-Tuple{Real, Real}" href="#ModelVerification.relaxed_relu_gradient-Tuple{Real, Real}"><code>ModelVerification.relaxed_relu_gradient</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">relaxed_relu_gradient(l::Real, u::Real)</code></pre><p>Return the slope of a ReLU activation based on its lower and upper bounds</p><p>Returns <code>0</code> if u&lt;0, <code>1</code> if l&gt;0, <code>u/(u-l)</code> otherwise</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L242-L248">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.to_comment-Tuple{Any}" href="#ModelVerification.to_comment-Tuple{Any}"><code>ModelVerification.to_comment</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Prepend <code>//</code> to each line of a string.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L50-L52">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ModelVerification.write_nnet-Tuple{Any, Any}" href="#ModelVerification.write_nnet-Tuple{Any, Any}"><code>ModelVerification.write_nnet</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">write_nnet(filename, network[; header_text])</code></pre><p>Write <code>network</code> to filename.nnet. Note: Does not perform safety checks on inputs, so use with caution.</p><p>Based on python code at https://github.com/sisl/NNet/blob/master/utils/writeNNet.py and follows .nnet format given here: https://github.com/sisl/NNet.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/intelligent-control-lab/ModelVerification.jl/blob/cf4a3ddd9d1125f0547ab94c3b2f700186eac0a3/src/utils/util.jl#L100-L108">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../problem/">« Problem Outline</a><a class="docs-footer-nextpage" href="../safety_spec/">Input-Output Specification »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.1.0 on <span class="colophon-date" title="Tuesday 21 November 2023 18:01">Tuesday 21 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
